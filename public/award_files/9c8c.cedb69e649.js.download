__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HYDRATE_PERFORMANCE_HOC_MARK=e.HYDRATE_MEANINGFUL_ELEMENT_MARK=e.FMP_TARGET_ID=void 0;e.FMP_TARGET_ID='FMP-target';e.HYDRATE_MEANINGFUL_ELEMENT_MARK='hydrate-meaningful-element';e.HYDRATE_PERFORMANCE_HOC_MARK='hydrate-performance-hoc'}),5046364,[]);
__d((function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}function n(){const t=r(d[1]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=babelHelpers.interopRequireDefault(r(d[2])),o=r(d[3]),l=r(d[4]),c=babelHelpers.interopRequireDefault(r(d[5])),u=r(d[6]),h=r(d[7]),p=babelHelpers.interopRequireDefault(r(d[8])),f=r(d[9]);var _=new class{constructor({isResetPageEventsEnabled:s,trackingModule:_}){this.trackingModule=void 0,this.performanceRecorders=[],this.ignorePathnameUpdate=void 0,this.includeHistoryUpdate=void 0,this.nextPageCreatedAt=void 0,this.resetPageEvents=void 0,this.pauseInfo={pauseStart:0,pauseDuration:0,pausePending:!1},this.currentPathname='',this.currentSearch='',this.setReadMetricsFromPerformanceRecorder=()=>{const t=Object.keys(n().PageName);window.__readMetricsFromPerformanceRecorder=()=>this.performanceRecorders.map(s=>{if(!s.isRecordingLoggable())return;const o=t.find(t=>n().PageName[t]===s.universalPageName),l={...s.readCalculatedMetrics(),ttfcp:s.throttleableMetrics.ttfcp,ttfmp:s.throttleableMetrics.ttfmp,fid:s.throttleableMetrics.fid,timeToFid:s.throttleableMetrics.timeToFid,cls:s.unthrottleableMetrics.cumulativeLayoutShift,lcp:s.throttleableMetrics.lcp,createdAt:s.createdAt,pageRequestMethod:s.pageRequestMethod},c=(0,h.calculatePagePerformanceScore)(l);return{...l,pageName:o,score:c}}).filter(t=>!!t)},this.updateCurrentRecorderWithHOCProps=t=>{const n=this.performanceRecorders[this.performanceRecorders.length-1];n&&(n.universalPageName=t.universalPageName,n.subPageName=t.subPageName,n.impressionUuid=t.impressionUuid,n.eventData=t.eventData,n.eventDataSchema=t.eventDataSchema,n.isDirectRequest||n.setTTFCP(t.timestampOfFCP))},this.handleNewHistory=t=>{t.listen(this.onHistoryChange)},this.setIgnorePathnameUpdate=t=>{this.ignorePathnameUpdate=t},this.clearIgnorePathnameUpdate=()=>{this.ignorePathnameUpdate=void 0},this.setIncludeHistoryUpdate=t=>{this.includeHistoryUpdate=t},this.clearIncludeHistoryUpdate=()=>{this.includeHistoryUpdate=void 0},this.startNextPageTimer=()=>{this.nextPageCreatedAt=(0,c.default)().now(),this.pauseInfo.pausePending=!1,this.pauseInfo.pauseStart=0,this.pauseInfo.pauseDuration=0},this.pauseNextPageTimer=()=>{this.pauseInfo.pausePending=!0,this.pauseInfo.pauseStart=(0,c.default)().now()},this.resumeNextPageTimer=()=>{this.pauseInfo.pausePending?(this.pauseInfo.pausePending=!1,this.pauseInfo.pauseDuration+=(0,c.default)().now()-this.pauseInfo.pauseStart,this.pauseInfo.pauseStart=0):(0,o.airdogCount)('page_transition_coordinator.page_timer.error',1,['error:pause',"pathname:"+window.location.pathname])},this.createNewRecorder=({isDirectRequest:t})=>{const n=this.performanceRecorders[this.performanceRecorders.length-1];n&&n.retire(),this.resetPageEvents&&!t&&u.delays.resetPageEvents();const s=this.getNextPageCreatedAt();this.performanceRecorders.push(new p.default({isDirectRequest:t,pageCreatedAt:s}))},this.getNextPageCreatedAt=()=>{let t;return this.nextPageCreatedAt&&this.pauseInfo.pauseDuration?t=this.nextPageCreatedAt+this.pauseInfo.pauseDuration:this.pauseInfo.pausePending?((0,o.airdogCount)('page_transition_coordinator.page_timer.error',1,['error:resume',"pathname:"+window.location.pathname]),t=this.nextPageCreatedAt):this.nextPageCreatedAt&&(t=this.nextPageCreatedAt),this.nextPageCreatedAt=void 0,t},this.onHistoryChange=(t,n)=>{const s=t.pathname,o=t.search;this.isPageTransition({action:n,prevPathname:this.currentPathname,prevSearch:this.currentSearch,nextPathname:s,nextSearch:o})&&(this.flushAllEvents(),this.createNewRecorder({isDirectRequest:!1})),this.currentPathname=s,this.currentSearch=o},this.isPageTransition=t=>{if('function'==typeof this.includeHistoryUpdate)return this.includeHistoryUpdate(t);const{action:n,prevPathname:s,nextPathname:o}=t;return!(!s||!o)&&(s!==o&&(('function'!=typeof this.ignorePathnameUpdate||!this.ignorePathnameUpdate(s,o))&&['POP','PUSH','REPLACE'].includes(n)))},this.flushAllEvents=()=>{var n;(0,l.isBot)()||(this.performanceRecorders.forEach(n=>{var s;if(n.retired||n.retire(),!n.isRecordingLoggable())return;const{problems:l,warnings:c}=n.getDataProblems();if(c.length>0&&(0,o.airdogCount)('page_transition_coordinator.data.warning',1,['error:data-warning',"pathname:"+window.location.pathname,...c.map(t=>"warning:"+t)]),l.length>0)return void(0,o.airdogCount)('page_transition_coordinator.data.error',1,['error:data-problems',"pathname:"+window.location.pathname,...l.map(t=>"problem:"+t)]);let u={};(0,f.enableInteractivitySpans)()&&(u={interactivity_spans:n.throttleableMetrics.interactivitySpans.map(t=>({duration:t.duration,name:t.name,long_task_durations:t.longTaskDurations,number_of_blocking_tasks:t.numberOfBlockingTasks,tbt:t.totalBlockingTime,longest_blocking_time:t.longestBlockingTime})),interactivity_span_aggregations:Object.entries(n.throttleableMetrics.interactivitySpanAggregations).reduce((t,[n,s])=>({...t,[n]:{tbt_per_second:s.totalBlockingTimePerSecond,number_of_blocking_tasks_per_second:s.numberOfBlockingTasksPerSecond,min_frame_drops_per_second:s.minFrameDropsPerSecond,count:s.count,duration:s.duration}}),{})}),null===(s=this.trackingModule)||void 0===s||s.queueJitneyEvent({schema:t().PerformanceWebPageMetricsEvent,event_data:{assets:n.unthrottleableMetrics.assets,page_request_method:n.pageRequestMethod,universal_page_name:n.universalPageName,subpage_name:n.subPageName,impression_uuid:n.impressionUuid,ttfcp:n.throttleableMetrics.ttfcp,ttfmp:n.throttleableMetrics.ttfmp,fid:n.throttleableMetrics.fid,tbt:n.throttleableMetrics.totalBlockingTime,event_data:n.eventData,event_data_schema:n.eventDataSchema,domain_and_path:n.domainAndPath,network_information:n.networkInformation,web_performance_timing:n.throttleableMetrics.webPerformanceTiming,tbt_pre_hydrate:n.throttleableMetrics.tbtPreHydrate,tbt_post_hydrate:n.throttleableMetrics.tbtPostHydrate,time_to_hydrate:n.throttleableMetrics.timeToHydrate,recorder_duration:n.throttleableMetrics.recorderDuration,time_to_fid:n.throttleableMetrics.timeToFid,number_of_blocking_tasks:n.throttleableMetrics.numberOfBlockingTasks,number_of_long_input_delays:n.unthrottleableMetrics.numberOfLongInputDelays,total_duration_of_long_input_delays:n.unthrottleableMetrics.totalDurationOfLongInputDelays,long_input_delays:n.unthrottleableMetrics.longInputDelays,long_input_delay_counts:n.unthrottleableMetrics.longInputDelayCounts,timed_interactions:n.unthrottleableMetrics.timedInteractions,longest_blocking_time:n.throttleableMetrics.longestBlockingTime,longest_blocking_task_index:n.throttleableMetrics.longestBlockingTaskIndex,cumulative_layout_shift:n.unthrottleableMetrics.cumulativeLayoutShift,lcp:n.throttleableMetrics.lcp,...u,document_age:n.unthrottleableMetrics.documentAge,inline_stylesheet_rules:n.unthrottleableMetrics.inlineStylesheetRules,external_stylesheet_rules:n.unthrottleableMetrics.externalStylesheetRules}})}),this.performanceRecorders=[],null===(n=this.trackingModule)||void 0===n||n.getLogger().flushEventQueue())},this.setPageCloseHandlers=()=>{window.addEventListener('beforeunload',this.flushAllEvents,!0),window.addEventListener('visibilitychange',()=>{'hidden'===document.visibilityState&&this.flushAllEvents()}),(0,l.isSafari)()&&window.addEventListener('pagehide',this.flushAllEvents)},this.currentPathname=window.location.pathname,this.currentSearch=window.location.search,this.resetPageEvents=null==s||s,this.createNewRecorder({isDirectRequest:!0}),this.trackingModule=_,this.setPageCloseHandlers(),this.setReadMetricsFromPerformanceRecorder()}}({trackingModule:s.default});e.default=_}),5046365,[4653131,4915363,4653111,4915321,4915257,4915231,4653080,5046369,5046370,5046377]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getPageRequestMethod=function(t){return(function(){const{navigator:t}=window;return void 0===t?Promise.resolve(!1):'serviceWorker'in t&&t.serviceWorker.getRegistration?t.serviceWorker.getRegistration('/').then(t=>!(!t||!t.active)).catch(()=>!1):Promise.resolve(!1)})().then(t=>{if(!t)return!1;const o=g.window&&(0,l.default)();if(!o||!o.getEntriesByType)return!1;const s=o.getEntriesByType('navigation');if(!s||0===s.length)return n.default.get('isServiceWorkerAppShell');const c=s[0].serverTiming;return!(!c||0===c.length)&&c.filter(t=>'serviceWorker'===t.name).length>0}).catch(()=>!1).then(n=>t?Promise.resolve(2):n?Promise.resolve(4):1===u?Promise.resolve(5):Promise.resolve(1))};var t=babelHelpers.interopRequireDefault(r(d[0])),n=babelHelpers.interopRequireDefault(r(d[1])),o=babelHelpers.interopRequireDefault(r(d[2])),s=babelHelpers.interopRequireDefault(r(d[3])),l=babelHelpers.interopRequireDefault(r(d[4])),c=r(d[5]);let u;!(function(){if((0,s.default)())return;const f=(function(){const n=(0,t.default)('cache_state');return'0'===n?2:'1'===n?1:void 0})();u=f;const{pathname:v}=document.location;let p=v.lastIndexOf('/');for(;-1!==p;){const n=v.slice(0,p);(0,t.default)('cache_state',-1,{expires:-1,domain:(0,o.default)(),path:n+"/"}),p=n.lastIndexOf('/')}const h=Date.now(),{tracking_context:b=null}=n.default.get('layout-init')||{};if(b&&b.action&&b.action.includes('app_shell'))return;const y=h-(n.default.get('pageGeneratedAt')||h)>6e5;void 0===f&&(u=y?1:3);const _=g.window&&(0,l.default)();let S=3;if(_&&_.getEntriesByType){const t=_.getEntriesByType('navigation');if(t&&t.length>0){var k;const n=null===(k=t[0].serverTiming)||void 0===k?void 0:k.find(t=>'cdn-cache'===t.name);'HIT'===(null==n?void 0:n.description)?S=1:'MISS'===(null==n?void 0:n.description)&&(S=2)}}3!==S&&(u=S),(0,c.airdogCount)('cache_state_comparison',1,{cookieCacheState:String(f),pageAgeLooksCached:String(y),serverTimingCacheState:String(S)})})()}),5046366,[4653116,4653076,4915261,5046368,4915231,4915321]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return t.default.get('china-guest-loop')};var t=babelHelpers.interopRequireDefault(r(d[0]))}),5046368,[4653076]);
__d((function(g,r,i,a,m,e,d){"use strict";function t(t,c,n){const f=Math.log(t),o=Math.log(c/t),u=Math.sqrt(1-3*o-Math.sqrt((o-3)*(o-3)-8))/2;return(1-(function(t){const c=t<0?-1:1,n=1/(1+.3275911*(t=Math.abs(t)));return c*(1-n*(.254829592+n*(n*(1.421413741+n*(1.061405429*n-1.453152027))-.284496736))*Math.exp(-t*t))})((Math.log(n)-f)/(Math.SQRT2*u)))/2}Object.defineProperty(e,"__esModule",{value:!0}),e.calculatePagePerformanceScore=function(c){const n=(function({ttfcp:c,ttfmp:n,tbt:f,fid:o,cls:u}){return{ttfcp:t(2500,.08491351406,c||0),ttfmp:t(3e3,244.5719961,n||0),fid:t(170,.6089337333,o||0),tbt:t(1250,167.2687485,f||0),cls:t(.15,1.889923697e-7,u||0)}})(c);return.35*n.ttfcp+.15*n.ttfmp+.3*n.fid+.15*n.tbt+.05*n.cls}}),5046369,[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=babelHelpers.interopRequireDefault(r(d[0])),s=babelHelpers.interopRequireDefault(r(d[1])),n=r(d[2]),o=r(d[3]),l=babelHelpers.interopRequireDefault(r(d[4])),c=r(d[5]),h=r(d[6]),u=r(d[7]),p=babelHelpers.interopRequireDefault(r(d[8])),b=r(d[9]),f=r(d[10]);const v=new Set(['click','input','keypress']);class y{constructor({isDirectRequest:T,pageCreatedAt:M}){this.networkInformation=(0,h.getNetworkInformation)(),this.initialVisibilityState=(0,l.default)(),this.isDirectRequest=void 0,this.isClientSideRequest=void 0,this.performance=(0,s.default)(),this.createdAt=void 0,this.pageRequestMethod=1,this.domainAndPath=`${window.location.host}${window.location.pathname}`,this.recorderController=void 0,this.throttleableMetrics={longTasks:[],interactivitySpans:[],interactivitySpanAggregations:{}},this.unthrottleableMetrics={assets:{},longInputDelays:[],longInputDelayCounts:[],numberOfLongInputDelays:0,timedInteractions:[],totalDurationOfLongInputDelays:0,resources:[]},this.longTaskObserver=void 0,this.inputDelayObserver=void 0,this.timedInteractionObserver=void 0,this.resourcesObserver=void 0,this.clsObserver=void 0,this.lcpObserver=void 0,this.retired=!1,this.universalPageName=void 0,this.subPageName=void 0,this.impressionUuid=void 0,this.eventData=void 0,this.eventDataSchema=void 0,this.showLogs=(0,n.getTreatmentOverride)('pps'),this.retire=async()=>{var t;this.retired||(this.retired=!0,this.cleanUpLongTasks(),this.cleanupLongInputDelayObserver(),this.cleanupTimedInteractionObserver(),this.cleanUpResources(),this.cleanUpClsObserver(),this.cleanUpLcpObserver(),this.recordStylesheetRuleLength(),this.throttleableMetrics.recorderDuration=this.performance.now()-this.createdAt,this.throttleableMetrics.timeToHydrate=this.calculateTimeToHydrate(),this.hasNecessaryPolyfills()&&window.perfMetrics.stopSearchingForFirstMeaningfulPaint(),null===(t=this.recorderController)||void 0===t||t.abort(),this.recorderController=void 0)},this.getDataProblems=()=>{const{ttfcp:t,ttfmp:s}=this.throttleableMetrics,n=[],o=[];return t&&t<0&&n.push('ttfcp-negative'),t&&t>6e4&&n.push('ttfcp-exceeds-60s'),s||o.push('ttfmp-not-found'),{problems:n,warnings:o}},this.readCalculatedMetrics=()=>{const t=this.calculateTimeToHydrate();return{tbt:(0,u.calculateTotalBlockingTime)(this.throttleableMetrics),tbtPreHydrate:(0,u.calculateTbtPreHydrate)(this.throttleableMetrics,t),tbtPostHydrate:(0,u.calculateTbtPostHydrate)(this.throttleableMetrics,t),timeToHydrate:t,numberOfBlockingTasks:(0,u.calculateNumberOfBlockingTasks)(this.throttleableMetrics),longestBlockingTime:(0,u.calculateLongestBlockingTaskIndex)(this.throttleableMetrics),longestBlockingTaskIndex:(0,u.calculateLongestBlockingTaskIndex)(this.throttleableMetrics)}},this.gatherUnthrottleableMetrics=()=>{this.listenForResources(),this.listenForCLS(),this.listenForLongInputDelays(),this.listenForTimedInteractions()},this.gatherThrottleableMetrics=()=>{this.listenForFCP(),this.listenForFMP(),this.listenForFID(),this.listenForLongTasks(),this.listenForLCP(),this.throttleableMetrics.webPerformanceTiming={...(0,h.getWWWCdnProvider)(),...this.isDirectRequest&&(0,h.getWebPerformanceTiming)()}},this.isRecordingLoggable=()=>void 0!==this.throttleableMetrics.ttfcp,this.listenForFCP=()=>{this.isClientSideRequest||window.perfMetrics.onFirstContentfulPaint(this.setTTFCP)},this.setTTFCP=t=>{this.retired||this.throttleableMetrics.ttfcp||(this.throttleableMetrics.ttfcp=t-this.createdAt,this.isClientSideRequest&&(this.performance.mark('TTFCP_END'),this.performance.measure('TTFCP',"CSR_PAGE_START",'TTFCP_END')),this.showLogs&&this.consoleLogMetrics())},this.listenForFMP=()=>{this.retired||(this.isClientSideRequest&&window.perfMetrics.startSearchingForFirstMeaningfulPaint(),window.perfMetrics.onFirstMeaningfulPaint(this.setTTFMP))},this.setTTFMP=t=>{(0,o.dispatchEvent)('TTFMP'),this.retired||(this.throttleableMetrics.ttfmp=t-this.createdAt,this.isClientSideRequest&&(this.performance.mark('TTFMP_END'),this.performance.measure('TTFMP',"CSR_PAGE_START",'TTFMP_END')),this.showLogs&&this.consoleLogMetrics())},this.listenForFID=()=>{window.perfMetrics.clearFirstInputDelay(),window.perfMetrics.onFirstInputDelay(this.setFID)},this.setFID=(t,s)=>{if(this.retired)return;this.throttleableMetrics.fid=t;const n=s.timeStamp-this.createdAt;n>=0&&(this.throttleableMetrics.timeToFid=n),this.showLogs&&this.consoleLogMetrics()},this.listenForTimedInteractions=()=>{if(this.supportsPerformanceObserverWithType('element')){this.cleanupTimedInteractionObserver(),this.timedInteractionObserver=new PerformanceObserver(t=>{y.lastInputDelayEvent&&(t.getEntries().forEach(t=>{this.recordTimedInteraction(t)}),y.lastInputDelayEvent=void 0)});try{this.timedInteractionObserver.observe({type:'element',buffered:this.isDirectRequest})}catch(t){}}},this.recordTimedInteraction=t=>{const s=y.lastInputDelayEvent;if(!s)return;const{element:n,identifier:o,name:l,renderTime:c}=t,h={element_type:'image-paint'===l?'image':'text',identifier_type:o,previous_target_ancestor_section_id:s.target_ancestor_section_id,start_time:s.start_time,target_ancestor_section_id:this.findAncestorSectionId(n),total_time:Math.round(c-s.start_time)};this.unthrottleableMetrics.timedInteractions.push(h)},this.cleanupTimedInteractionObserver=()=>{if(!this.timedInteractionObserver)return;'function'==typeof this.timedInteractionObserver.takeRecords&&this.timedInteractionObserver.takeRecords();const{timedInteractions:t}=this.unthrottleableMetrics;this.unthrottleableMetrics.timedInteractions=t.slice(0,20),this.timedInteractionObserver.disconnect()},this.listenForLongInputDelays=()=>{if(this.supportsPerformanceObserverWithType('event')){this.inputDelayObserver=new PerformanceObserver(t=>{let s;t.getEntries().forEach(t=>{this.recordLongInputDelay(t),v.has(t.name)&&(s=t)}),s&&(y.lastInputDelayEvent=this.createLongInputRecord(s))});try{this.inputDelayObserver.observe({type:'event',buffered:this.isDirectRequest})}catch(t){}}},this.createLongInputRecord=t=>{const{duration:s,name:n,processingEnd:o,processingStart:l,startTime:c,target:h}=t,u=l-c;return{input_delay:Math.round(u),input_duration:s,event_type:n,start_time:Math.round(c),target_ancestor_section_id:this.findAncestorSectionId(h),total_time:Math.round(o-c)}},this.recordLongInputDelay=t=>{const{name:s,processingStart:n,startTime:o}=t;if(!v.has(s))return;if(n-o<100)return;const l=this.createLongInputRecord(t);this.unthrottleableMetrics.longInputDelays.push(l)},this.cleanupLongInputDelayObserver=()=>{if(!this.inputDelayObserver)return;'function'==typeof this.inputDelayObserver.takeRecords&&this.inputDelayObserver.takeRecords();let t=0;const s=new Map;this.unthrottleableMetrics.longInputDelays.forEach(({event_type:n,total_time:o})=>{t+=o;let l=s.get(n);l||(l={event_count:0,total_duration:0,event_name:n},s.set(n,l)),l.event_count+=1,l.total_duration+=o}),this.unthrottleableMetrics.longInputDelayCounts=Array.from(s.values()),this.unthrottleableMetrics.numberOfLongInputDelays=this.unthrottleableMetrics.longInputDelays.length,this.unthrottleableMetrics.totalDurationOfLongInputDelays=t,this.unthrottleableMetrics.longInputDelays=this.unthrottleableMetrics.longInputDelays.sort((t,s)=>s.total_time-t.total_time).slice(0,20),this.inputDelayObserver.disconnect()},this.listenForLongTasks=()=>{if(this.supportsPerformanceObserverWithType('longtask'))try{this.longTaskObserver=new PerformanceObserver(t=>{this.throttleableMetrics.longTasks.push(...t.getEntries())}),this.longTaskObserver.observe({type:'longtask',buffered:this.isDirectRequest})}catch(t){}},this.cleanUpLongTasks=()=>{this.longTaskObserver&&('function'==typeof this.longTaskObserver.takeRecords&&this.throttleableMetrics.longTasks.push(...this.longTaskObserver.takeRecords()),this.throttleableMetrics.totalBlockingTime=(0,u.calculateTotalBlockingTime)(this.throttleableMetrics),this.showLogs&&this.consoleLogMetrics(),this.throttleableMetrics.longestBlockingTime=(0,u.calculateLongestBlockingTime)(this.throttleableMetrics),this.throttleableMetrics.longestBlockingTaskIndex=(0,u.calculateLongestBlockingTaskIndex)(this.throttleableMetrics),this.throttleableMetrics.tbtPreHydrate=(0,u.calculateTbtPreHydrate)(this.throttleableMetrics,this.calculateTimeToHydrate()),this.throttleableMetrics.tbtPostHydrate=(0,u.calculateTbtPostHydrate)(this.throttleableMetrics,this.calculateTimeToHydrate()),this.throttleableMetrics.numberOfBlockingTasks=(0,u.calculateNumberOfBlockingTasks)(this.throttleableMetrics),(0,f.enableInteractivitySpans)()&&(this.throttleableMetrics.interactivitySpans=(0,f.getInteractivitySpans)({start:this.createdAt,end:this.performance.now()}).map(t=>({name:t.name,duration:t.end-t.start,...(0,u.calculateInteractivityMetricsInInterval)(this.throttleableMetrics,t)})),this.throttleableMetrics.interactivitySpanAggregations=(0,f.aggregateInteractivitySpans)(this.throttleableMetrics.interactivitySpans)),this.longTaskObserver.disconnect())},this.calculateTimeToHydrate=()=>{const t=[...this.performance.getEntriesByName(b.HYDRATE_PERFORMANCE_HOC_MARK),...this.performance.getEntriesByName(b.HYDRATE_MEANINGFUL_ELEMENT_MARK)].filter(t=>t.startTime>this.createdAt);if(0!==t.length)return t.reduce((t,s)=>t.startTime<s.startTime?t:s,t[0]).startTime-this.createdAt},this.listenForCLS=()=>{if(this.supportsPerformanceObserverWithType('layout-shift'))try{this.clsObserver=new PerformanceObserver(this.clsObserverCallback),this.unthrottleableMetrics.cumulativeLayoutShift=0,this.clsObserver.observe({type:'layout-shift',buffered:this.isDirectRequest})}catch(t){}},this.clsObserverCallback=t=>{t.getEntries().forEach(t=>{t.hadRecentInput||(this.unthrottleableMetrics.cumulativeLayoutShift=this.unthrottleableMetrics.cumulativeLayoutShift||0,this.unthrottleableMetrics.cumulativeLayoutShift+=t.value,this.showLogs&&this.consoleLogMetrics())})},this.cleanUpClsObserver=()=>{this.clsObserver&&('function'==typeof this.clsObserver.takeRecords&&this.clsObserver.takeRecords(),this.clsObserver.disconnect())},this.listenForResources=()=>{if(this.supportsPerformanceObserverWithType('resource'))try{this.resourcesObserver=new PerformanceObserver(t=>{this.unthrottleableMetrics.resources.push(...t.getEntries())}),this.resourcesObserver.observe({type:'resource',buffered:this.isDirectRequest})}catch(t){}},this.cleanUpResources=()=>{this.resourcesObserver&&('function'==typeof this.resourcesObserver.takeRecords&&this.unthrottleableMetrics.resources.push(...this.resourcesObserver.takeRecords()),this.unthrottleableMetrics.assets=(0,p.default)({resources:this.unthrottleableMetrics.resources,universalPageName:this.universalPageName}),this.resourcesObserver.disconnect())},this.recordStylesheetRuleLength=()=>{let t=0,s=0;if(document.styleSheets){for(let n=0;n<document.styleSheets.length;n++)try{document.styleSheets[n].href?s+=document.styleSheets[n].rules.length:t+=document.styleSheets[n].rules.length}catch(t){}this.unthrottleableMetrics.inlineStylesheetRules=t,this.unthrottleableMetrics.externalStylesheetRules=s}},this.listenForLCP=()=>{if(!this.isClientSideRequest&&this.supportsPerformanceObserverWithType('largest-contentful-paint'))try{this.lcpObserver=new PerformanceObserver(t=>{t.getEntries().forEach(this.updateLCP)}),this.lcpObserver.observe({type:'largest-contentful-paint',buffered:!0})}catch(t){}},this.updateLCP=t=>{this.throttleableMetrics.lcp=t.startTime},this.cleanUpLcpObserver=()=>{this.lcpObserver&&('function'==typeof this.lcpObserver.takeRecords&&this.lcpObserver.takeRecords().forEach(this.updateLCP),this.lcpObserver.disconnect())},this.supportsPerformanceObserverWithType=t=>'undefined'!=typeof PerformanceObserver&&(!!PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes(t)),this.findAncestorSectionId=t=>{let s=null,n=t;for(;null===s&&n;)s=n.getAttribute('data-section-id')||n.getAttribute('data-testid'),n=n.parentElement;return s||void 0},this.hasNecessaryPolyfills=()=>!!window.perfMetrics,this.consoleLogMetrics=()=>{const{ttfcp:t,ttfmp:s,totalBlockingTime:n,fid:o}=this.throttleableMetrics,{cumulativeLayoutShift:l}=this.unthrottleableMetrics;console.log(`Page Performance Score metrics (air.bb/web-pps)\n\nPathname = %c${window.location.pathname}%c\n  Time To First Contentful Paint = ${this.prettyMetric({metric:t})}\n  Time To First Meaningful Paint = ${this.prettyMetric({metric:s})}\n  First Input Delay              = ${this.prettyMetric({metric:o,isFid:!0})}\n  Total Blocking Time            = ${this.prettyMetric({metric:n,isTbt:!0})}\n  Cumulative Layout Shift        = ${this.prettyMetric({metric:l,isCls:!0})}`,'font-weight: bold;','')},this.prettyMetric=({metric:t,isFid:s,isTbt:n,isCls:o})=>{let l='';return l=o?(t||0).toFixed(2):t?Math.round(t).toLocaleString()+" ms":'...',l=l.padStart(9,' '),s&&void 0===t&&(l+=" (click to see)"),n&&void 0===t&&(l+=" (background tab to calculate)"),l},this.isDirectRequest=T,this.isClientSideRequest=!T,T?this.createdAt=0:(this.performance.mark("CSR_PAGE_START"),this.createdAt=M||this.performance.now()),(0,c.getPageRequestMethod)(this.isClientSideRequest).then(t=>{this.pageRequestMethod=t}),this.isClientSideRequest?this.unthrottleableMetrics.documentAge=0:t.default.get('pageGeneratedAt')&&(this.unthrottleableMetrics.documentAge=Math.max(Date.now()-t.default.get('pageGeneratedAt'),0)),this.gatherUnthrottleableMetrics(),2!==this.initialVisibilityState&&this.hasNecessaryPolyfills()&&this.gatherThrottleableMetrics()}}e.default=y,y.lastInputDelayEvent=void 0}),5046370,[4653076,4915231,4915322,4915202,5046371,5046366,5046372,5046373,5046374,5046364,5046377]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){switch(document.visibilityState){case'visible':return 1;case'hidden':return 2;case'prerender':return 3;default:return 4}}}),5046371,[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getWWWCdnProvider=function(){return{www_cdn_provider:t.default.get('wwwCdnProvider')||'Unknown'}},e.getNetworkInformation=function(){if(window.navigator&&window.navigator.connection){const{connection:t}=window.navigator;return{effective_type:t.effectiveType,rtt:t.rtt,downlink:t.downlink}}return},e.getWebPerformanceTiming=function(){if(window.performance&&window.performance.timing){const{navigationStart:t,redirectStart:n,redirectEnd:_,fetchStart:o,domainLookupStart:s,domainLookupEnd:c,connectStart:u,connectEnd:v,secureConnectionStart:w,requestStart:f,responseStart:p,responseEnd:l,domLoading:E,domInteractive:S,domContentLoadedEventStart:k,domContentLoadedEventEnd:C,domComplete:L,loadEventStart:b,loadEventEnd:P}=window.performance.timing;return{navigation_start_timestamp_in_ms:t,time_to_redirect_start_in_ms:n,time_to_redirect_end_in_ms:_,time_to_fetch_start_in_ms:o,time_to_domain_lookup_start_in_ms:s,time_to_domain_lookup_end_in_ms:c,time_to_connect_start_in_ms:u,time_to_connect_end_in_ms:v,time_to_secure_connection_start_in_ms:w,time_to_request_start_in_ms:f,time_to_response_start_in_ms:p,time_to_response_end_in_ms:l,time_to_dom_loading_in_ms:E,time_to_dom_interactive_in_ms:S,time_to_dom_content_loaded_event_start_in_ms:k,time_to_dom_content_loaded_event_end_in_ms:C,time_to_dom_complete_in_ms:L,time_to_load_event_start_in_ms:b,time_to_load_event_end_in_ms:P}}};var t=babelHelpers.interopRequireDefault(r(d[0]))}),5046372,[4653076]);
__d((function(g,r,i,a,m,e,d){"use strict";function t(t,n){const{longTasks:c}=t,{start:u,end:o}=n;return c.filter(t=>t.startTime>=u&&(!o||t.startTime<o)).sort((t,n)=>t.startTime-n.startTime).map((t,n)=>({entry:t,index:n}))}function n(t){return t.reduce((t,n)=>t+n.entry.duration-50,0)}function c(c,u){return n(t(c,u))}function u(t){if(0!==t.length)return t.reduce((t,n)=>n.entry.duration>t.entry.duration?n:t,t[0])}function o(n){const{ttfcp:c=0}=n;return u(t(n,{start:c}))}function l(t){if(t)return t.entry.duration-50}Object.defineProperty(e,"__esModule",{value:!0}),e.calculateInteractivityMetricsInInterval=function(c,o){const s=t(c,o);return{longTaskDurations:s.map(t=>t.entry.duration),totalBlockingTime:n(s),numberOfBlockingTasks:s.length,longestBlockingTime:l(u(s))}},e.calculateTotalBlockingTime=function(t){const{ttfcp:n=0}=t;return c(t,{start:n})},e.calculateTbtPreHydrate=function(t,n){const{ttfcp:u=0}=t;if(void 0===n)return;return c(t,{start:u,end:n})},e.calculateTbtPostHydrate=function(t,n){const{ttfcp:u=0}=t;if(void 0===n)return;return c(t,{start:Math.max(n,u)})},e.calculateNumberOfBlockingTasks=function(t){return t.longTasks.length},e.calculateLongestBlockingTime=function(t){return l(o(t))},e.calculateLongestBlockingTaskIndex=function(t){var n;return null===(n=o(t))||void 0===n?void 0:n.index}}),5046373,[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({resources:s,universalPageName:c}){var l,u,h,f,y;if(0===s.length||s.length>0&&void 0===s[0].decodedBodySize)return;const p=['link','img','css','script','other'],_=[{type:'css',initiatorList:['link'],regex:/^.+(muscache|localhost).+\.css(\?.*)?$/},{type:'img',initiatorList:['img','css','link'],regex:/^.+(muscache|localhost).+(jpg|jpeg|png|gif|webp)(\?.*)?$/},{type:'js',category:'airbnb',initiatorList:['link','script'],regex:/^.+(muscache|localhost).+\.m?(js|bundle)(\?.*)?$/},{type:'js',category:'third_party',initiatorList:['link','script'],regex:/^((?!(muscache|localhost)).)*\.m?js(\?.*)?$/},{type:'font',initiatorList:['link','css','other'],regex:/^.+(muscache|localhost).+\.woff2(\?.*)?$/}],v={css:{...n},js:{airbnb:{...n},third_party:{...n}},img:{...n},font:{...n}},b=[],j=t.default.getBootstrap('instrument_search_results_images');var z,k;s.filter(({initiatorType:t})=>p.includes(t)).forEach(({duration:t,name:n,initiatorType:s,decodedBodySize:l,transferSize:u,encodedBodySize:h})=>{_.find(({type:f,initiatorList:y,regex:p,category:_})=>{if(y.includes(s)&&n.match(p)){const s=_?v[f][_]:v[f];if(j&&'img'===f&&2e3===c&&Math.random()<=.001){const s=(0,o.createJitneyPropsForImageResource)({duration:t,encodedBodySize:h,name:n,transferSize:u});s&&b.push(s)}const y=s.count*s.cache_hit_ratio+(0===u?1:0);return s.count+=1,s.cache_hit_ratio=y?y/s.count:0,s.transfer_size+=u,s.encodedbody_size+=h,s.decodedbody_size+=l,!0}return!1})}),v.css=null!==(l=v.css)&&void 0!==l&&l.count?v.css:void 0,null!==(u=v.js)&&void 0!==u&&null!==(h=u.airbnb)&&void 0!==h&&h.count?0===(null===(z=v.js)||void 0===z||null===(k=z.third_party)||void 0===k?void 0:k.count)&&(v.js.third_party.cache_hit_ratio=1):v.js=void 0;v.img=null!==(f=v.img)&&void 0!==f&&f.count?v.img:void 0,v.font=null!==(y=v.font)&&void 0!==y&&y.count?v.font:void 0,j&&b.length&&(0,o.sendJitneyEventsForImages)(b);if(!Object.values(v).find(t=>!!t))return;return v};var t=babelHelpers.interopRequireDefault(r(d[0])),o=r(d[1]);const n={transfer_size:0,encodedbody_size:0,decodedbody_size:0,count:0,cache_hit_ratio:0}}),5046374,[4915312,5046375]);
__d((function(g,r,i,a,m,e,d){"use strict";function n(){const t=r(d[0]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.sendJitneyEventsForImages=function(o){o.forEach(o=>{t.default.logJitneyEvent({schema:n().PerformanceImageDownloadEvent,event_data:o})})},e.createJitneyPropsForImageResource=function({duration:n,encodedBodySize:t,name:f,transferSize:_}){if(!n||n<=0)return;if(!t||t<=0)return;const l=(function(n){if(o.test(n))return'ImageManager';if(u.test(n)&&!c.test(n))return'LegacyAkamai';return'Unknown'})(f);if('Unknown'===l)return;const y='ImageManager'===l?(p=f,s(p,/im_w=(\w+)/)):(function(n){return s(n,/aki_policy=(\w+)/)})(f);var p;return{image_cache_type:0===_?1:0,image_size_bytes:t,image_download_time_ms:Math.floor(n),image_policy:y,image_url:f}};var t=babelHelpers.interopRequireDefault(r(d[1]));const o=/(?:im_w|im_q)/,u=/aki_policy=/,c=/im\/pictures\/user/;function s(n,t){if(!n)return;const o=n.match(t);return o?o[1]:void 0}}),5046375,[5046376,4653111]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PerformanceImageDownloadEvent=void 0;var n={defaultProps:{schema:'com.airbnb.jitney.event.logging.Performance:PerformanceImageDownloadEvent:2.0.0',event_name:'performance_image_download'},propTypes:{}};e.PerformanceImageDownloadEvent=n,n.fullyQualifiedName='Performance.v2.PerformanceImageDownloadEvent'}),5046376,[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.beginInteractivitySpan=function(t){o(t,'BEGIN')},e.endInteractivitySpan=function(t){o(t,'END')},e.getInteractivitySpans=function(t){const o=(0,n.default)(),u=Object.values(s).reduce((t,n)=>[...t,...o.getEntriesByName(c(n,'BEGIN'),'mark'),...o.getEntriesByName(c(n,'END'),'mark')],[]).filter(n=>n.startTime>=t.start&&n.startTime<t.end);return u.sort((t,n)=>t.startTime-n.startTime),(function(t,n){const s=new Set,c=new Map,o=[];return t.forEach(t=>{const{name:u,event:E}=(function(t){const n=t.endsWith('_END')?'END':'BEGIN';return{name:t.slice('PPS_SPAN_'.length,-(n.length+1)),event:n}})(t.name);'BEGIN'===E?c.has(u)||c.set(u,t.startTime):(c.has(u)?o.push({name:u,start:c.get(u),end:t.startTime}):s.has(u)||o.push({name:u,start:n.start,end:t.startTime}),c.delete(u),s.add(u))}),c.forEach((t,s)=>{o.push({name:s,start:t,end:n.end})}),o})(u,t)},e.aggregateInteractivitySpans=function(t){const n=new Map;t.forEach(t=>{var s;const{name:c}=t;n.has(c)||n.set(c,[]),null===(s=n.get(c))||void 0===s||s.push(t)});const s={};return n.forEach((t,n)=>{const c=t.reduce((t,n)=>t+n.duration,0),o=t.reduce((t,n)=>t+n.totalBlockingTime,0),u=t.reduce((t,n)=>t+n.numberOfBlockingTasks,0),E=t.flatMap(t=>t.longTaskDurations),N=E.map(t=>(t-16.666666666666668)/16.666666666666668).reduce((t,n)=>t+n,0);0!==c&&(s[n]={totalBlockingTimePerSecond:o/c*1e3,numberOfBlockingTasksPerSecond:u/c*1e3,minFrameDropsPerSecond:N/c*1e3,duration:c,count:t.length})}),s},e.enableInteractivitySpans=function(){return!!t.default.getBootstrap('web_pps_interactivity_spans')},e.InteractivitySpanName=void 0;var t=babelHelpers.interopRequireDefault(r(d[0])),n=babelHelpers.interopRequireDefault(r(d[1]));let s;function c(t,n){return`PPS_SPAN_${t}_${n}`}function o(t,s){(0,n.default)().mark(c(t,s))}e.InteractivitySpanName=s,(function(t){t.DESKTOP_MAP_INTERACTION="DESKTOP_MAP_INTERACTION",t.MOWEB_MAP_INTERACTION="MOWEB_MAP_INTERACTION",t.MOWEB_MAP_USER_INTERACTION="MOWEB_MAP_USER_INTERACTION",t.DESKTOP_MAP_CHANGE_INTERACTION="DESKTOP_MAP_CHANGE_INTERACTION"})(s||(e.InteractivitySpanName=s={}))}),5046377,[4915312,4915231]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/9c8c.6f77f53c70.js.map